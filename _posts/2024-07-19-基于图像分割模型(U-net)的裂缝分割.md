---
layout: post
comments: true
published: True
title: " 基于图像分割模型(U-net)的裂缝分割"
excerpt: "裂缝图像的分割和提取技术对裂缝的视觉检测和长期监测具有重要意义。本文针对墙裂缝提取需求，构建基于深度学习U-Net模型的智能壁画裂缝语义分割模型。该模型能智能检测复杂背景墙体中的裂缝，并分割出裂缝区域，对光照、阴影的干扰具有极高鲁棒性。"
date:   2024-07-18 22:00:00
mathjax: false
---

### 研究意义
裂缝图像的分割和提取技术对裂缝的视觉检测和长期监测具有重要意义。传统阈值分割技术，该方法通过图像灰度信息强制分割裂缝和背景区域。这种非智能的分割方式未考虑裂缝图像中的语义信息极易受可变的环境光照影响，直接导致长期监测结果的波动。

本文针对墙裂缝提取需求，构建基于深度学习U-Net模型的智能壁画裂缝语义分割模型。该模型能智能检测复杂背景墙体中的裂缝，并分割出裂缝区域，对光照、阴影的干扰具有极高鲁棒性。

### 模型选择
深度学习模型选择关乎图像语义分割的效果。优秀的模型却又受限于训练数据集数据集大小、硬件设备性能、模型发展理论。适宜的建筑裂缝分割模型应具备模型轻量化、少量数据驱动、高精度高性能的特点。
<p style="text-align: center;">
<img src="https://wdj-data-1328038871.cos.ap-nanjing.myqcloud.com/blog_data%2F%E8%A3%82%E7%BC%9D%E5%88%86%E5%89%B2%2F1721317032343.jpg"  style="zoom:60%" />
</p>
U-Net网络是对称U型结构，由左侧收缩路径下采样卷积层和右侧扩张路径上采样转置卷积层两个阶段组成。第一阶段图像先经过Encoder编码器进行下采样得到高级语义特征图：重复应用两个3×3卷积(padding=0)，每个卷积后面为线性修正单元(ReLU)和一个2×2最大池运算(strid=2)用于下采样。在每次下采样中，特征通道数量加倍。第二阶段再经过Decoder解码器上采样将特征图恢复到原图片的分辨率：下采样的特征图经过上采样和2×2卷积与收缩路径中相应裁剪的特征图进行串联，然后经过两个3×3卷积。在最后一层，使用1×1卷积将每个分量特征向量映射到所需的类别数。该网络共有23个卷积层


**优化策略**
- 模型输入由原始572×572×1改为512×512×3，以适应采集的裂缝图像大多为RGB三通道的需求。
- 原始模型未添加padding每次卷积都会丢失边界像素，因此在Skip连接中需要进行裁剪。且输出图像比输入图像小一个恒定的宽度不利于裂缝面积的评估。为此，改进模型在卷积中添加了补零操作(padding=2)以达到等宽卷积的目的。U-Net结构左右完全对称有效避免了裁剪特征图的繁杂操作。
- 增加BN层(Batch Normalization, BN)解决隐含层数据分布不均的问题，提升训练模型效率。
- 更为丰富的数据增强策略：随机翻转（上下、左右）、随机颜色（色调、饱和度、明暗程度）、随机裁剪、模糊操作。
- 调整的超参数优化策略，以达到高性能语义分割效果。

### 模型训练
将采集的墙面裂缝随机裁剪成大小为512×512的子图，生成了148张墙体裂缝。为补充数据集提升模型性能，加入了156张GitHub开源混凝土裂缝图像。由此生成了大小为304张的墙面数据集库。Image Labeler标注304张墙面裂缝。
利用NVDIA 3090 GPU对改进后的U-Net模型进行训练。经过多轮的模型迭代和调参分析，我们发现：改进的U-Net裂缝语义分割模型在超参数选择中极为敏感，不同的超参数导致模型性能差异。我们根据不同超参数模型性能的比选最终选择超参数如下：选择骰子损失(Dice Loss)作为模型的损失函数，该损失函数能有效应对图像中只有少量裂缝区域这类数据不平衡的情况。优化算法选择为SGD，初始学习率为0.0045，采用多项式衰减进行学习率衰减。批量大小设置为4，迭代轮数为40 Epoch。最终模型训练在第27个Epoch达到最大MIoU，为0.8946。
<p style="text-align: center;">
<img src="https://wdj-data-1328038871.cos.ap-nanjing.myqcloud.com/blog_data%2F%E8%A3%82%E7%BC%9D%E5%88%86%E5%89%B2%2F1721317155791.jpg"  style="zoom:60%" />
</p>

模型在验证集的mIoU、oAcc、kappa系数评估结果如下：
<p style="text-align: center;">
<img src="https://wdj-data-1328038871.cos.ap-nanjing.myqcloud.com/blog_data%2F%E8%A3%82%E7%BC%9D%E5%88%86%E5%89%B2%2F1721317173418.jpg"  style="zoom:60%" />
</p>
我们迭代的第27个Epoch模型在测试集合获得了平均准确率：mAcc=0.9899平均交并比：mIoU=0.8946

混淆矩阵结果如下：
<p style="text-align: center;">
<img src="https://wdj-data-1328038871.cos.ap-nanjing.myqcloud.com/blog_data%2F%E8%A3%82%E7%BC%9D%E5%88%86%E5%89%B2%2F1721317186507.jpg"  style="zoom:60%" />
</p>

改进的U-Ne裂缝语义分割模型在测试集预测效果：
<p style="text-align: center;">
<img src="https://wdj-data-1328038871.cos.ap-nanjing.myqcloud.com/blog_data%2F%E8%A3%82%E7%BC%9D%E5%88%86%E5%89%B2%2F1721317233652.jpg"  style="zoom:60%" />
</p>

<p style="text-align: center;">
<img src="https://wdj-data-1328038871.cos.ap-nanjing.myqcloud.com/blog_data%2F%E8%A3%82%E7%BC%9D%E5%88%86%E5%89%B2%2F1721318056054.jpg"  style="zoom:60%" />
</p>

### 结论
- 经过对比分析发现，改进的U-Net语义分割模型在裂缝长期生长变化监测中表现优异。该方法与传统的阈值分割相比主要优势表现在：裂缝语义分割结果精确，受壁画、环境光照和阴影干扰性小。
- 该方法与传统的阈值分割相比主要优势表现在：裂缝语义分割结果精确，受壁画、环境光照和阴影干扰性小。长期监测数据稳定、波动性小，该方法将COV系数由2.85%降低至1.80%。
